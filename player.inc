; JUGADOR Y MOVIMIENTO - PLAYER.INC


.DATA
    JUGADOR_X DW 160
    JUGADOR_Y DW 120
    DIRECCION DB 0

.CODE

; INICIALIZAR JUGADOR

INICIALIZAR_JUGADOR PROC
    MOV JUGADOR_X, 160
    MOV JUGADOR_Y, 120
    MOV DIRECCION, 0
    RET
INICIALIZAR_JUGADOR ENDP


; DIBUJAR JUGADOR

DIBUJAR_JUGADOR PROC
    PUSH AX
    PUSH BX
    PUSH CX
    PUSH DX
    PUSH SI
    PUSH DI
    
    MOV CX, JUGADOR_X
    MOV DX, JUGADOR_Y
    MOV SI, 16       ; Ancho
    MOV DI, 16       ; Alto
    
DIBUJAR_FILA_JUGADOR:
    PUSH CX
    MOV BX, SI
    
DIBUJAR_COLUMNA_JUGADOR:
    MOV AH, 0CH
    MOV AL, COLOR_ROJO
    MOV BH, 0
    INT 10H
    INC CX
    DEC BX
    JNZ DIBUJAR_COLUMNA_JUGADOR
    
    POP CX
    INC DX
    DEC DI
    JNZ DIBUJAR_FILA_JUGADOR
    
    POP DI
    POP SI
    POP DX
    POP CX
    POP BX
    POP AX
    RET
DIBUJAR_JUGADOR ENDP


; ACTUALIZAR VIEWPORT 

ACTUALIZAR_VIEWPORT PROC
    ; Por ahora no hacer nada - usar mapa completo
    RET
ACTUALIZAR_VIEWPORT ENDP


; VERIFICAR COLISIONES

VERIFICAR_COLISION PROC
    ; Convertir posición a coordenadas de mapa
    MOV AX, JUGADOR_X
    MOV BX, JUGADOR_Y
    ADD AX, 8
    ADD BX, 8
    
    MOV CX, 16
    XOR DX, DX
    DIV CX
    MOV SI, AX
    
    MOV AX, BX
    XOR DX, DX
    DIV CX
    MOV DI, AX
    
    MOV AX, DI
    MOV CX, 20
    MUL CX
    ADD AX, SI
    MOV BX, AX
    
   
    CMP BYTE PTR MAPA_DATOS[BX], 1
    JE COLISION_DETECTADA
    CMP BYTE PTR MAPA_DATOS[BX], 2
    JE COLISION_DETECTADA
    
    CLC
    RET
    
COLISION_DETECTADA:
    STC
    RET
VERIFICAR_COLISION ENDP